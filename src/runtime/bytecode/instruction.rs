use crate::structs::primitive::PrimitiveWithValue;
use anyhow::{anyhow, Result};
use std::fmt::{Display, Formatter};

//TODO: for each instruction with >1 variants, macro their definitions
/*
   ALOAD_N,
   ASTORE_N,
   DCONST_D,
   DLOAD_N,
   DSTORE_N,
   FCONST_N,
   FLOAD_N,
   FSTORE_N,
   ICONST_N,
   ILOAD_N,
   ISTORE_N
   LCONST_N,
   LLOAD_N,
   LSTORE_N
*/

pub enum Instruction {
    AALOAD,
    AASTORE,
    ACONST_NULL,
    ALOAD,
    ALOAD_N,
    ANEWARRAY,
    ARETURN,
    ARRAYLENGTH,
    ASTORE,
    ASTORE_N,
    ATHROW,
    BALOAD,
    BASTORE,
    BIPUSH,
    CALOAD,
    CASTORE,
    CHECKCAST,
    D2F,
    D2I,
    D2L,
    DADD,
    DALOAD,
    DASTORE,
    DCMPG,
    DCMPL,
    DCONST_N,
    DDIV,
    DLOAD,
    DLOAD_N,
    DMUL,
    DNEG,
    DREM,
    DRETURN,
    DSTORE,
    DSTORE_N,
    DSUB,
    DUP,
    DUP_X1,
    DUP_X2,
    DUP2,
    DUP2_X1,
    DUP2_X3,
    F2D,
    F2I,
    F2L,
    FADD,
    FALOAD,
    FASTORE,
    FCMPG,
    FCMPL,
    FCONST_N,
    FDIV,
    FLOAD,
    FLOAD_N,
    FMUL,
    FNEG,
    FREM,
    FRETURN,
    FSTORE,
    FSTORE_N,
    FSUB,
    GETFIELD,
    GETSTATIC,
    GOTO,
    GOTO_W,
    I2B,
    I2C,
    I2D,
    I2F,
    I2L,
    I2S,
    IADD,
    IALOAD,
    IAND,
    IASTORE,
    ICONST_N,
    IDIV,
    IF_ACMPEQ,
    IF_ACMPNE,
    IF_ICMPEQ,
    IF_ICMPNE,
    IF_ICMPLT,
    IF_ICMPGT,
    IF_ICMPLE,
    IFEQ,
    IFNE,
    IFLT,
    IFGE,
    IFGT,
    IFLE,
    IFNOTNULL,
    IFNULL,
    IINC,
    ILOAD,
    ILOAD_N,
    IMUL,
    INEG,
    INSTANCEOF,
    INVOKEDYNAMIC,
    INVOKEINTERFACE,
    INVOKESPECIAL,
    INVOKESTATIC,
    INVOKEVIRTUAL,
    IOR,
    IREM,
    IRETURN,
    ISHL,
    ISHR,
    ISTORE,
    ISTORE_N,
    ISUB,
    IUSHR,
    IXOR,
    JSR,
    JSR_W,
    L2D,
    L2F,
    L2I,
    LADD,
    LALOAD,
    LAND,
    LASTORE,
    LCMP,
    LCONST_N,
    LMUL,
    LNEG,
    LOOKUPSWITCH,
    LOR,
    LREM,
    LRETURN,
    LSHL,
    LSHR,
    LSTORE,
    LSTORE_N,
    LSUB,
    LUSHR,
    LXOR,
    MONITORENTER,
    MONITOREXIT,
    MULTIANEWARRAY,
    NEW,
    NEWARRAY,
    NOP,
    POP,
    POP2,
    PUTFIELD,
    PUTSTATIC,
    RET,
    RETURN,
    SALOAD,
    SASTORE,
    SIPUSH,
    SWAP,
    TABLESWTICH,
    WIDE,
}

impl Instruction {
    pub fn from_byte(byte: u8) -> Result<Instruction> {
        match byte {
            0xb2 => Ok(Instruction::GETSTATIC),
            _ => Err(anyhow!("unknown instruction {}", byte)),
        }
    }
}

pub enum OperandType {
    Primitive(PrimitiveWithValue),
    Reference(),
}
